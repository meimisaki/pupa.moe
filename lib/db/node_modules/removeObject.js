'use strict';

var Syncher = require('../../syncher');

function removeObject(key, id, callback) {
	var client = this._;
	var last = key.split(':').pop();
	var syncher = new Syncher();
	if (last != key) syncher.add(client.zrem.bind(client, key + '-list', id));
	syncher.add(client.zrem.bind(client, last + '-list', id));
	syncher.add(client.del.bind(client, last + ':' + id));
	syncher.run(function () {
		for (var key = 0 ; key < arguments.length ; ++key) {
			var err = arguments[key][0];
			if (err) return callback(err);
		}
		callback();
	});
}

module.exports = removeObject;
