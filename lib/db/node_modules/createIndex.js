'use strict';

var each = require('../../each');

function createIndex(key, id, tags, callback) {
	var client = this._;
	var args = [key + ':' + id + '@index'];
	each(tags, function (tag) {
		tag = tag.trim().toLowerCase();
		for (var start = 0 ; start < tag.length ; ++start)
			for (var end = start + 1 ; end <= tag.length ; ++end) {
				args.push(tag.slice(start, end));
			}
	});
	args.push(callback);
	client.sadd.apply(client, args);
}

module.exports = createIndex;
