'use strict';

var Syncher = require('../../syncher');

function getUser(id, callback) {
	var client = this._;
	var syncher = new Syncher();
	syncher.add(this.getObject.bind(this, 'user', id));
	syncher.add(client.get.bind(client, 'token:' + id));
	syncher.run(function (userArgs, tokenArgs) {
		var err = userArgs[0];
		if (err) return callback(err);
		var user = userArgs[1];
		var token = tokenArgs[1];
		user && (user.token = token);
		callback(null, user);
	});
}

module.exports = getUser;
